<div class="container-fluid">
    <div class="  header_section text-center text-white">
        <h1>Stock Auto Pilot</h1>
    </div>
    <br />
    <div class="container">
        <div class="row">
            <div class="col-md-10"></div>
            <div class="col-md-2" align="right">
                <button type="button" style="background-color: #f06bac; ;border-color: #FB525A ;color: #fff;"
                    class="btn  float-end" routerLink="/TransactionReport"><strong>Today's
                        Report</strong>
                </button>
            </div>
        </div>
    </div>
    <div class="container bg-white p-3 mt-3" *ngIf="!isOnView && !isOnEdit" style="border-radius: 20px; width: 90%;box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px; border: 1px solid
        #FB525A!important;">
        <!--section for delete pop up-->
        <p-confirmDialog header="Confirmation" icon="pi pi-exclamation-triangle"
            [breakpoints]="{'960px': '30vw', '640px': '80vw'}" [style]="{width: '30vw'}"></p-confirmDialog>



        <div class="row">
            <div class="col-md-10">
                <div class="d-flex  justify-content-between">
                    <p class="fs-4 mt-2"> <strong>Manage Scripts</strong> </p>
                </div>
            </div>


            <div class="col-md-2" align="right">
                <button type="button" style="background-color: #FB525A ;border-color: #FB525A ;color: #fff;"
                    class="btn mt-2 mb-2 float-end" (click)="openNav()"><strong>Add Script</strong>
                </button>
            </div>

        </div>

        <div class="row" *ngIf="!isOnView || !isOnEdit">

            <div class="col-3">
                <div class="form-floating text-muted fs-6">
                    <input type="text" class="form-control" id="scriptName" placeholder="pan"
                        style="border-radius: 12px; height: 50px;" name="scriptName" [(ngModel)]="filter.scriptName"
                        (ngModelChange)="onFilter(1)">
                    <label for="scriptName" class="p-2">Script Name</label>
                </div>
            </div>
            <div class="col-3">
                <div class="form-floating text-muted fs-6">
                    <input type="date" class="form-control" id="startDate" placeholder="Trade Created/Start Date"
                        style="border-radius: 12px; height: 50px;" name="startDate" [(ngModel)]="filter.startDate"
                        placeholder="dd/mm/yyyy" (ngModelChange)="onFilter(2)">
                    <label for="startDate" class="p-2">Trade Created/Start Date</label>
                </div>
            </div>

            <div class="col-md-3">

                <div class="form-floating fs-6 ">

                    <select style="height: 25px;" class="form-select" id="floatingSelect" name="scriptActiveStatus"
                        aria-placeholder="Select Status" id="scriptActiveStatus" #scriptActiveStatus
                        (change)="filterByStatus(scriptActiveStatus.value)">
                        <option value="1" selected>Active</option>
                        <option value="2">Deleted</option>
                        <option value="3">All</option>
                    </select>
                    <label for="floatingSelect">Select Status</label>

                </div>


            </div>
            <div class="col-1"></div>
            <div class="col-2" align="right">
                <button type="button" style="background-color: #FB525A;border-color: #FB525A;color: #fff;"
                    class="btn  mt-2 mb-2 float-end ">
                    <strong>Start Script</strong> </button>

            </div>

        </div>


        <div class="card border-0 px-3 mt-3" style="width:100%;margin: auto" *ngIf="!isOnView || !isOnEdit">

            <div class="row ps-1">

                <div class="px-3">
                    <p-table id="scriptsList" dataKey="id" [value]="scriptsList" [rowHover]="true" [rows]="25"
                        [showCurrentPageReport]="true" [rowsPerPageOptions]="[25,50,100,150]" responsiveLayout="scroll"
                        [paginator]="true" [filterDelay]="0" [style]="{'float':'right !important'}"
                        [globalFilterFields]="['scriptName','investmentAmount','startDate', 'buyMargin','sellMargin','resetCriteria','quantity_balance','avgPrice','currentPrice','deal','activeFlag','action']"
                        sortField="" [sortOrder]="-1">
                        <ng-template pTemplate="caption">
                            <div class="d-flex justify-content-between">
                                <p class="fs-5 mt-2">View Script</p>
                            </div>
                        </ng-template>

                        <ng-template pTemplate="header">
                            <tr style="font-size: 15px;">
                                <th pSortableColumn="id" style="width: 8%;">
                                    <div class="flex justify-content-between align-items-center">Id
                                        <!-- <p-sortIcon field="id"></p-sortIcon> -->

                                    </div>
                                </th>
                                <th pSortableColumn="scriptName" style="width: 14%;">
                                    <div class="flex justify-content-between align-items-center">Script Name


                                    </div>
                                </th>
                                <th pSortableColumn="investmentAmount" style="width: 15%;">
                                    <div class="flex justify-content-between align-items-center">Investment Amount

                                    </div>
                                </th>
                                <th pSortableColumn="startDate" style="width: 18%;">
                                    <div class="flex justify-content-between align-items-center"> Created
                                        Date

                                    </div>
                                </th>

                                <!-- <th pSortableColumn="buyMargin" style="width: 12%;">
                                    <div class="flex justify-content-between align-items-center">Buy Margin

                                    </div>
                                </th>
                                <th pSortableColumn="sellMargin" style="width: 12%;">
                                    <div class="flex justify-content-between align-items-center">Sell Margin

                                    </div>
                                </th> -->
                                <!-- <th pSortableColumn="resetCriteria" style="width: 12%;">
                                    <div class="flex justify-content-between align-items-center"> Reset Criteria

                                    </div>
                                </th> -->

                                <th pSortableColumn="quantity_balance" style="width: 14%;">
                                    <div class="flex justify-content-between align-items-center">Qty Balance

                                    </div>
                                </th>
                                <th pSortableColumn="avgPrice" style="width: 12%;">
                                    <div class="flex justify-content-between align-items-center">Avg Price

                                    </div>
                                </th>
                                <th pSortableColumn="currentPrice" style="width: 12%;">
                                    <div class="flex justify-content-between align-items-center">Current Price

                                    </div>
                                </th>
                                <th pSortableColumn="deal" style="width: 12%;">
                                    <div class="flex justify-content-between align-items-center">Deal

                                    </div>
                                </th>
                                <th pSortableColumn="activeFlag" style="width: 10%;" id="status-column">

                                    <div class="flex justify-content-center align-items-center">
                                        Status

                                    </div>
                                </th>
                                <th colspan="6" pSortableColumn="action" style="width: 10%;">
                                    <div class="p-d-flex p-jc-between p-ai-center" align="center"> Action
                                    </div>
                                </th>
                            </tr>
                            <tr>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>

                                <th></th>
                                <th>
                                    <p-columnFilter field="activeFlag" matchMode="equals" [showMenu]="false">
                                        <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                                            <p-dropdown [options]="statuses" (onChange)="filter($event.value)"
                                                placeholder="Any" [showClear]="true">
                                                <ng-template let-option pTemplate="item">
                                                    <span [class]="'customer-badge status-' + option">{{option}}</span>
                                                </ng-template>
                                            </p-dropdown>
                                        </ng-template>
                                    </p-columnFilter>
                                </th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>

                            </tr>

                        </ng-template>

                        <ng-template pTemplate="body" let-scripts>
                            <tr>
                                <td>{{scripts.id}}</td>
                                <td>{{scripts.scriptName}}</td>
                                <td>{{scripts.investmentBalance}}
                                </td>
                                <td>{{scripts.startDate | date:'dd/MM/yyyy'}}
                                </td>
                                <!-- <td>
                                    {{scripts.buyMargin}}
                                </td>
                                <td>
                                    {{scripts.sellMargin}}
                                </td> -->
                                <!-- <td>
                                    {{scripts.resetCriteria}}
                                </td> -->
                                <td>
                                    {{scripts.quantityBalance}}
                                </td>
                                <td>
                                    {{scripts.avgPrice}}
                                </td>
                                <td>
                                    {{scripts.currentprice}}
                                </td>
                                <td>
                                    +2000
                                </td>
                                <td> <span
                                        [class]="'scripts-badge activeFlag-' + scripts.activeFlag">{{scripts.activeFlag}}</span>
                                </td>

                                <!-- <td *ngIf="scripts.activeFlag == 1">
                                    Active
                                </td>

                                <td *ngIf="scripts.activeFlag == 0">
                                    Saved
                                </td>

                                <td *ngIf="scripts.activeFlag == 2">
                                    Paused
                                </td> -->

                                <!-- <td style="width:4px ;">
                                    <button pButton pRipple type="button" (click)="getScriptById(scripts.id)"
                                        title="View" icon="pi pi-eye" class="p-button-rounded "></button>
                                </td>

                                <td style="width:4px ;">
                                    <button pButton pRipple type="button" (click)="openNav()" title="Edit"
                                        icon="pi pi-pencil" class="p-button-rounded p-button-warning"></button>
                                </td> -->

                                <td style="width:4px ;">
                                    <button pButton pRipple type="button" (click)="getScriptById(scripts.id,1)"
                                        title="View" icon="pi pi-eye" class="p-button-rounded "></button>
                                </td>
                                <td style="width:4px ;">
                                    <button pButton pRipple type="button" (click)="getScriptById(scripts.id,2)"
                                        title="Edit" icon="pi pi-pencil"
                                        class="p-button-rounded p-button-warning"></button>
                                </td>



                                <td style="width:4px ;">

                                    <button pButton pRipple type="button" (click)="delete(scripts.id)" title="Delete"
                                        icon="pi pi-trash" class="p-button-rounded p-button-danger "></button>
                                </td>
                                <!-- <td style="width:4px ;"><button pButton pRipple type="button" title="Play"
                                        icon="pi pi-play" class="p-button-rounded p-button-help "
                                        *ngIf="scripts.activeFlag == 1" (click)="updateStatus(scripts.id, 0)"
                                        title="Play"></button>
                                    <button pButton pRipple type="button" title="Pause" icon="pi pi-pause"
                                        class="p-button-rounded p-button-success " *ngIf="scripts.activeFlag == 0"
                                        (click)="updateStatus(scripts.id, 1)" title="Pause"></button>

                                </td> -->
                                <td style="width:4px ;"><button pButton pRipple type="button" title="Play"
                                        icon="pi pi-play" class="p-button-rounded p-button-help "
                                        (click)="startProgram(scripts.id )" title="Play"
                                        *ngIf="(scripts.activeFlag=='Paused'||'Saved')"
                                        [disabled]="scripts.isdeleted==1"></button>
                                    <button pButton pRipple type="button" title="Pause" icon="pi pi-pause"
                                        class="p-button-rounded p-button-success "
                                        *ngIf="(scripts.activeFlag=='Live')&&(scripts.isdeleted!=1)"
                                        (click)="updateScriptStatus(scripts.id, 0)" title="Pause"></button>
                                </td>

                            </tr>
                        </ng-template>


                        <ng-template pTemplate="emptymessage">
                            <tr>
                                <td colspan="8">No Data found.</td>
                            </tr>
                        </ng-template>
                    </p-table>
                </div>
            </div>
        </div>
    </div>

    <div id="sidepanelId" class="sidepanel" [ngStyle]="{'width': panelWidth }">
        <div class="row" style="border-bottom:1px solid gray">
            <div class="col-12">
                <span class="panelTitle">{{title}}</span>
                <a class="closebtn" (click)="closeNav()">
                    <i class="fa fa-times" aria-hidden="true"></i>
                </a>
            </div>
        </div>
        <div class="row">
            <div class="col-12">

                <form #scriptForm="ngForm" (ngSubmit)="getFormData(scriptForm.value)">
                    <div class=" row mt-2">
                        <div class="col-4">
                            <label class="form-label">Script Name</label>
                        </div>
                        <div class="col-4">
                            <input type="text" name="scriptName" id="scriptName" disabled *ngIf="isOnView || isOnEdit"
                                [(ngModel)]="scriptData.scriptName">
                            <p-dropdown [options]="scriptCodes" name="selectedScript" *ngIf="!isOnView&&!isOnEdit"
                                [(ngModel)]="selectedScript" optionLabel="name" [filter]="true" filterBy="name"
                                [showClear]="true" placeholder="Select a Script">
                                <ng-template pTemplate="filter" let-options="options">
                                    <div class="flex p-3">
                                        <div class="p-inputgroup" (click)="$event.stopPropagation()">
                                            <span class="p-inputgroup-addon"><i class="pi pi-search"></i></span>
                                            <input type="text" pInputText placeholder="Filter" name="filterValue"
                                                [(ngModel)]="filterValue" (keyup)="options.filter($event)">
                                            <button style="padding: 20px;" pButton icon="pi pi-times"
                                                class="ml-3"></button>
                                        </div>

                                    </div>
                                </ng-template>
                                <ng-template pTemplate="selectedItem">
                                    <div class="country-item country-item-value" *ngIf="selectedScript">
                                        <div>{{selectedScript.name}}</div>
                                    </div>
                                </ng-template>
                                <ng-template let-script pTemplate="item">
                                    <div class="script-item">
                                        <div>{{script.name}}</div>
                                    </div>
                                </ng-template>
                            </p-dropdown>
                        </div>
                    </div>

                    <div class="row mt-2">
                        <div class="col-4">
                            <label class="form-label">Investment Amount</label>
                        </div>
                        <div class="col-6">
                            <input id="investmentAmount" #investmentAmount="ngModel" [disabled]="isOnView"
                                [(ngModel)]="scriptData.investmentBalance" class="form-control" type="text"
                                name="investmentAmount" required pattern="[0-9]*"
                                [ngClass]="{'is-invalid': (scriptForm.submitted && investmentAmount.invalid && !flag) || (investmentAmount.invalid && investmentAmount.touched && !flag) }">
                        </div>
                    </div>

                    <div class="row mt-2">
                        <div class="col-4">
                            <label class="form-label">Buy Limit(Margin)</label>
                        </div>
                        <div class="col-6">
                            <input id="buyMargin" class="form-control" #buyMargin="ngModel" [disabled]="isOnView"
                                [(ngModel)]="scriptData.buyMargin" name="buyMargin" type="text" required
                                [ngClass]="{'is-invalid': (scriptForm.submitted && buyMargin.invalid && !flag ) || (buyMargin.invalid && buyMargin.touched && !flag) }"
                                style="display:inline-block;width: 50%" />%
                        </div>
                    </div>

                    <div class="row mt-2">
                        <div class="col-4">
                            <label class="form-label">Sell Limit(Margin)</label>
                        </div>
                        <div class="col-6">
                            <input id="sellMargin" class="form-control" #sellMargin="ngModel" name="sellMargin"
                                [disabled]="isOnView" [(ngModel)]="scriptData.sellMargin" type="text" required
                                [ngClass]="{'is-invalid': (scriptForm.submitted && sellMargin.invalid && !flag ) || (sellMargin.invalid && sellMargin.touched && !flag) }"
                                style="display:inline-block;width: 50%" />%
                        </div>
                    </div>

                    <div class="row mt-2">
                        <div class="col-4">
                            <label class="form-label">Reset Criteria</label>
                        </div>

                        <div class="col-8">
                            <!-- <div class="form-check">
                            <input id="resetCriteria" #resetCriteria="ngModel" [(ngModel)]="scripts.resetCriteria"
                             class="form-check-input" type="radio" checked
                            [ngClass]="{'is-invalid': (scriptForm.submitted && resetCriteria.invalid && !flag) || (resetCriteria.invalid && resetCriteria.touched) && !flag }"
                            name="resetCriteria">
                            < label class="form-check-label">
                              Spot Price
                                < /label>
                              </div>

                              <div class="form-check">
                              <input id="marginalBuyId" class="form-check-input" #resetCriteria="ngModel"
                               [(ngModel)]="scripts.resetCriteria"
                               [ngClass]="{'is-invalid': (scriptForm.submitted && resetCriteria.invalid && !flag) || (resetCriteria.invalid && resetCriteria.touched && !flag) }"
                                name="resetCriteria" type="radio" name="resetCriteria">
                               <label class="form-check-label">
                                Marginal Buy
                                  </label>
                                < /div>

                              <div class="form-check">
                               <input id="specificValueId" class="form-check-input" #resetCriteria="ngModel"
                                [(ngModel)]="scripts.resetCriteria"
                                 [ngClass]="{'is-invalid': (scriptForm.submitted && resetCriteria.invalid && !flag ) || (resetCriteria.invalid && resetCriteria.touched && !flag) }"
                                 name="resetCriteria" type="radio" name="resetCriteria">
                                 <label class="form-check-label">
                                Specific Value
                                 </label>
                                 </div> -->
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="resetCriteria" id="resetCriteria1"
                                    value="1" checked>
                                <label class="form-check-label" for="resetCriteria1">
                                    Spot Price
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="resetCriteria" id="resetCriteria2"
                                    value="2">
                                <label class="form-check-label" for="resetCriteria2">
                                    Marginal Buy
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="resetCriteria" id="resetCriteria3"
                                    value="3">
                                <label class="form-check-label" for="resetCriteria3">
                                    Specific Value
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="row mt-2">
                        <div class="col-4">
                            <label class="form-label">Exchange</label>
                        </div>
                        <div class="col-8">
                            <div class="form-check">
                                <input id="exchange" class="form-check-input" type="radio" value="BSE" checked
                                    name="exchange">
                                <label class="form-check-label">
                                    BSE
                                </label>
                            </div>

                            <div class="form-check">
                                <input id="nse_exchange" class="form-check-input" value="NSE" checked name="exchange"
                                    type="radio" checked>
                                <label class="form-check-label">
                                    NSE
                                </label>
                            </div>
                        </div>

                    </div>
                    <div class="row mt-2">
                        <div class="col-4"></div>
                        <div class="col-6">
                            <div class="row">
                                <!-- <div class="col-2">
                                      <button type="submit" style=" background-color:#FB525A ;color: #fff;"
                                      class="btn btn-secondary" [disabled]="scriptForm.invalid"
                                       (click)="addScript(scriptForm.value)">Save</button>
                                        </div> -->

                                <div class="col-2">
                                    <button class="btn btn-secondary" *ngIf=" !isOnView"
                                        style="background-color:#FB525A ;color: #fff; ">Save</button>
                                </div>
                                <div class="col-2">
                                    <input type="reset" class="btn btn-secondary" value="Reset" *ngIf=" !isOnView"
                                        class="btn btn-secondary"
                                        style="background-color:#FB525A ;color: #fff; border-radius: 6px; ">
                                </div>
                                <div class="col-2">
                                    <a style="background-color:#FB525A ;color: #fff; " class="btn btn-secondary"
                                        (click)="closeNav()">Cancel</a>
                                </div>


                            </div>
                        </div>
                    </div>

                </form>
            </div>
        </div>
    </div>

    <!--View Form -->
    <div class="card border-0 px-3 mt-3" style="width:100%;margin: auto" *ngIf="isOnView || isOnEdit">

        <div class="container bg-white p-3 mt-3"
            style="border-radius: 20px; width: 90%;box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px; border: 1px solid #FB525A!important;">


            <div class="card border-0 px-3 mb-3" style="width:100%;margin: auto;">
                <div class="row">
                    <p class="fs-4 m-1"><strong>{{title_form}}</strong></p>
                </div>
                <br />
                <div class="card border-0 px-6 " style="width:100%;margin: auto;">
                    <div class="row">
                        <form #addscriptForm="ngForm"></form>
                        <div class="row">
                            <div class="col-lg-3 mb-1">
                                <div class="form-floating text-muted fs-6">
                                    <input type="text" class="form-control" placeholder="Script Name" name="scriptName"
                                        style="border-radius: 12px; height: 50px;" [(ngModel)]="scriptData.scriptName"
                                        type="text" required disabled>


                                    <label for="Script Name" class="p-2">Script Name<span style="color: red;">
                                            *</span></label>
                                </div>
                            </div>
                            <div class="col-lg-3 mb-1">
                                <div class="form-floating text-muted fs-6">
                                    <input type="text" class="form-control" placeholder="Investment Amount"
                                        [(ngModel)]="scriptData.investmentBalance" name="investmentBalance"
                                        style="border-radius: 12px; height: 50px;" disabled required pattern="[0-9]*"
                                        [ngClass]="{'is-invalid': (scriptForm.submitted && investmentAmount.invalid && !flag) || (investmentAmount.invalid && investmentAmount.touched && !flag) }">

                                    <label for="Investment Amount" class="p-2">Investment Amount<span
                                            style="color: red;">
                                            *</span></label>
                                </div>
                            </div>
                            <div class="col-lg-3 mb-1">
                                <div class="form-floating text-muted fs-6">
                                    <input type="text" class="form-control" placeholder="Buy Limit" name="buyMargin"
                                        style="border-radius: 12px; height: 50px;" required [disabled]="isOnView"
                                        pattern="^(100|[1-9][0-9]?)$" [(ngModel)]="scriptData.buyMargin"
                                        [ngClass]="{'is-invalid': (scriptForm.submitted && buyMargin.invalid && !flag ) || (buyMargin.invalid && buyMargin.touched && !flag) }">

                                    <label for="Buy Limit" class="p-2">Buy Limit<span style="color: red;">
                                            *</span></label>
                                </div>
                            </div>


                            <div class="col-lg-3 mb-1">
                                <div class="form-floating text-muted fs-6">
                                    <input type="text" class="form-control" placeholder="Sell Limit"
                                        #sellMargin="ngModel" name="sellMargin" [(ngModel)]="scripts.sellMargin"
                                        type="text" required pattern="^(100|[1-9][0-9]?)$" [disabled]="isOnView"
                                        [(ngModel)]="scriptData.sellMargin"
                                        [ngClass]="{'is-invalid': (scriptForm.submitted && sellMargin.invalid && !flag ) || (sellMargin.invalid && sellMargin.touched && !flag) }"
                                        style="border-radius: 12px; height: 50px;">

                                    <label for="Sell Limit" class="p-2">Sell Limit<span style="color: red;">
                                            *</span></label>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-4 mb-1">
                            <label for="Reset Criteria" class="p-2">Reset Criteria<span style="color: red;">
                                    *</span></label>
                            <div class="form-floating text-muted fs-6">

                                <div class="form-check form-check-inline">
                                    <input id="resetCriteria" #resetCriteria="ngModel" disabled
                                        [(ngModel)]="scripts.resetCriteria" class="form-check-input" type="radio"
                                        value="1"
                                        [ngClass]="{'is-invalid': (scriptForm.submitted && resetCriteria.invalid && !flag) || (resetCriteria.invalid && resetCriteria.touched) && !flag }"
                                        name="resetCriteria">
                                    <label class="form-check-label">
                                        Spot Price
                                    </label>
                                </div>

                                <div class="form-check form-check-inline">
                                    <input id="marginalBuyId" class="form-check-input" #resetCriteria="ngModel"
                                        [(ngModel)]="scripts.resetCriteria" value="2" disabled
                                        [ngClass]="{'is-invalid': (scriptForm.submitted && resetCriteria.invalid && !flag) || (resetCriteria.invalid && resetCriteria.touched && !flag) }"
                                        name="resetCriteria" type="radio" name="resetCriteria">
                                    <label class="form-check-label">
                                        Marginal Buy
                                    </label>
                                </div>

                                <div class="form-check form-check-inline">
                                    <input id="specificValueId" class="form-check-input" #resetCriteria="ngModel"
                                        [(ngModel)]="scripts.resetCriteria" value="3" disabled
                                        [ngClass]="{'is-invalid': (scriptForm.submitted && resetCriteria.invalid && !flag ) || (resetCriteria.invalid && resetCriteria.touched && !flag) }"
                                        name="resetCriteria" type="radio" name="resetCriteria">
                                    <label class="form-check-label">
                                        Specific Value
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-4 mb-1">
                            <label for="Exchange" class="p-2">Exchange<span style="color: red;">
                                    *</span></label>
                            <div class="form-floating text-muted fs-6">
                                <div class="form-check form-check-inline">
                                    <input id="bse_exchange" #exchange="ngModel" [(ngModel)]="scripts.exchange"
                                        class="form-check-input" type="radio" value="1" disabled
                                        [ngClass]="{'is-invalid': (scriptForm.submitted && exchange.invalid && !flag) || (exchange.invalid && exchange.touched) && !flag }"
                                        name="exchange">
                                    <label class="form-check-label">
                                        BSE
                                    </label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input id="nse_exchange" class="form-check-input" #exchange="ngModel"
                                        [(ngModel)]="scripts.exchange" value="2" disabled
                                        [ngClass]="{'is-invalid': (scriptForm.submitted && exchange.invalid && !flag) || (exchange.invalid && exchange.touched && !flag) }"
                                        name="resetCriteria" type="radio" name="resetCriteria">
                                    <label class="form-check-label">
                                        NSE
                                    </label>
                                </div>

                                <br /><br />

                            </div>
                        </div>

                    </div>


                </div>
                <div class="px-3 mt-3">


                    <p-table id="transactionData" dataKey="id" [value]="transactionData" [rowHover]="true" [rows]="25"
                        [showCurrentPageReport]="true" [rowsPerPageOptions]="[25,50,100,150]" responsiveLayout="scroll"
                        [paginator]="true" [filterDelay]="0" [style]="{'float':'right !important'}"
                        [globalFilterFields]="['start_date','start_time','bought_for','market_rate,buy_target,sell_target,quantity_balance,script_fund_balance,profit_loss']"
                        sortField="" [sortOrder]="-1">
                        <ng-template pTemplate="caption">
                            <div class="d-flex justify-content-between ">
                                <p class="fs-5 mt-2">View Stock Details</p>
                                <!-- <button style="height:40px" type="button" class="btn btn-secondary"
                                (click)="this.isOnView=false">Back
                            </button> -->
                            </div>


                        </ng-template>
                        <ng-template pTemplate="header">
                            <tr style="font-size: 14px;">
                                <th pSortableColumn="start_date" style="width: 4%; ">
                                    <div class="flex justify-content-between align-items-center">
                                        ID


                                    </div>

                                </th>
                                <th pSortableColumn="start_date" style="width: 10%; ">
                                    <div class="flex justify-content-between align-items-center">
                                        Start Date


                                    </div>

                                </th>
                                <th pSortableColumn="start_time" style="width: 10%;">
                                    <div class="flex justify-content-between align-items-center">
                                        Start Time

                                    </div>

                                </th>
                                <th pSortableColumn="bought_for" style="width: 10%; ">
                                    <div class="flex justify-content-between align-items-center">
                                        <!-- Bought For -->Order Type


                                    </div>
                                </th>
                                <th pSortableColumn="market_rate" style="width: 12%; ">
                                    <div class="flex justify-content-between align-items-center">
                                        QTY Slab

                                    </div>
                                </th>
                                <th pSortableColumn="buy_target" style="width: 10%; ">
                                    <div class="flex justify-content-between align-items-center">
                                        Buy Target


                                    </div>
                                </th>

                                <th pSortableColumn="sell_target" style="width: 10%; ">
                                    <div class="flex justify-content-between align-items-center">
                                        Sell Target


                                    </div>
                                </th>

                                <th pSortableColumn="quantity_balance" style="width: 10%; ">
                                    <div class="flex justify-content-between align-items-center">
                                        Qty Balance


                                    </div>
                                </th>
                                <th pSortableColumn="script_fund_balance" style="width: 8%; ">
                                    <div class="flex justify-content-between align-items-center">
                                        Script Fund Balance


                                    </div>
                                </th>
                                <th pSortableColumn="profit_loss" style="width: 10%; ">
                                    <div class="flex justify-content-between align-items-center">
                                        Profit/Loss


                                    </div>
                                </th>

                                <th pSortableColumn="profit_loss" style="width: 14%; ">
                                    <div class="flex justify-content-between align-items-center">
                                        Avg Price


                                    </div>
                                </th>

                                <!-- <th pSortableColumn="Status" style="width: 13%;" id="status-column">
                                <div class="flex justify-content-between align-items-center">
                                    Status
                                    <p-sortIcon field="Status"></p-sortIcon>
                                    <p-columnFilter field="Status" [style]="{'float':'right !important'}" display="menu"
                                        type="text" class="p-ml-auto">
                                    </p-columnFilter>
                                </div>
                            </th> -->
                                <!-- <th colspan="8" pSortableColumn="creationdate" style="width: 10%;">
                                    <div class="p-d-flex p-jc-between p-ai-center" align="center">
                                        Action
                                    </div>
                                </th> -->
                            </tr>
                        </ng-template>

                        <ng-template pTemplate="body" let-transactiondetails>
                            <tr>
                                <td>{{transactiondetails.scriptId}}</td>

                                <td>{{transactiondetails.orderDate | date: 'shortDate'}}</td>
                                <td>{{transactiondetails.orderDate | date:'mediumTime' }}</td>
                                <td>{{transactiondetails.orderType}}</td>
                                <td>{{transactiondetails.qtySlab}}</td>
                                <td>{{transactiondetails.buyTarget}}</td>
                                <td>{{transactiondetails.sellTarget}}</td>
                                <td>{{transactiondetails.qtyBalance}}</td>
                                <td>{{transactiondetails.scriptFundBalance}}</td>
                                <td>{{transactiondetails.profit}}</td>
                                <td>{{transactiondetails.buyRate}}</td>

                                <!-- <td style="width:4px ;"><a (click)="viewScriptById(1)"><i title="View"
                                            class="pi pi-eye"></i></a>
                                </td>
                                <td style="width:4px ;"><a (click)="editScriptById(1)"><i title="Edit"
                                            class="pi pi-pencil"></i></a>
                                </td>

                                <td style="width:4px ;"><a><i title="Delete" class="pi pi-trash"></i></a>
                                </td> -->
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="emptymessage">
                            <tr>
                                <td colspan="8">No Data found.</td>
                            </tr>
                        </ng-template>
                    </p-table>
                </div>
                <div class="row mt-6 p-1 mt-4">
                    <div class="col-lg-10"></div>
                    <div class="col-lg-2" align="center">
                        <button type="reset" (click)="viewMasterPage()"
                            style="width:90%; background-color:#FB525A ;color: #fff;"
                            class="btn btn-outline-secondary">Back</button>
                    </div>

                </div>
                <br />



            </div>
        </div>

    </div>

    <!--Edit details section-->